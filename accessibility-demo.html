<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessibility System Demo - Designetica</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #323130;
            background-color: #f3f2f1;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .header {
            border-bottom: 2px solid #0078d4;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        h1 {
            color: #0078d4;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }

        .subtitle {
            color: #605e5c;
            font-size: 1.2rem;
        }

        .demo-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #edebe9;
            border-radius: 6px;
            background: #faf9f8;
        }

        .demo-section h2 {
            color: #106ebe;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .button {
            display: inline-block;
            padding: 10px 20px;
            margin: 10px 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .button:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .button:focus {
            outline: 2px solid #0078d4;
            outline-offset: 2px;
        }

        .button-primary {
            background-color: #0078d4;
            color: #ffffff;
        }

        .button-secondary {
            background-color: #106ebe;
            color: #ffffff;
        }

        .button-success {
            background-color: #0e7214;
            color: #ffffff;
        }

        .button-danger {
            background-color: #d13438;
            color: #ffffff;
        }

        .color-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .color-card {
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            font-weight: 500;
        }

        .test-area {
            border: 2px dashed #edebe9;
            padding: 20px;
            margin: 15px 0;
            min-height: 100px;
            border-radius: 6px;
            background: #ffffff;
        }

        .result-box {
            margin: 15px 0;
            padding: 15px;
            border-radius: 6px;
            background: #fff4ce;
            border-left: 4px solid #f7b500;
        }

        .result-box.success {
            background: #dff6dd;
            border-color: #0e7214;
        }

        .result-box.error {
            background: #fde7e9;
            border-color: #d13438;
        }

        .log-output {
            background: #323130;
            color: #ffffff;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin: 10px 0;
        }

        .input-group {
            margin: 15px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #edebe9;
            border-radius: 4px;
            font-size: 14px;
        }

        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #0078d4;
            box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            text-align: center;
            padding: 15px;
            background: #ffffff;
            border: 1px solid #edebe9;
            border-radius: 6px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #0078d4;
        }

        .stat-label {
            color: #605e5c;
            font-size: 0.9rem;
        }

        .accessibility-report {
            background: #ffffff;
            border: 1px solid #edebe9;
            border-radius: 6px;
            padding: 20px;
            margin: 15px 0;
        }

        .issue-item {
            padding: 10px;
            margin: 5px 0;
            border-left: 4px solid #f7b500;
            background: #fff4ce;
        }

        .issue-item.error {
            border-color: #d13438;
            background: #fde7e9;
        }

        .issue-item.success {
            border-color: #0e7214;
            background: #dff6dd;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 2rem;
            }

            .color-grid {
                grid-template-columns: 1fr;
            }

            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üé® Accessibility System Demo</h1>
            <p class="subtitle">Comprehensive WCAG 2.1 AA compliance validation for Designetica wireframes</p>
        </div>

        <!-- Color Palette Demo -->
        <div class="demo-section">
            <h2>üìö Approved Color Palette</h2>
            <p>These are the WCAG-compliant colors available for wireframe generation:</p>
            <div class="color-grid" id="colorPalette">
                <!-- Colors will be populated by JavaScript -->
            </div>
        </div>

        <!-- Contrast Testing -->
        <div class="demo-section">
            <h2>üîç Contrast Ratio Testing</h2>
            <p>Test color combinations for WCAG compliance:</p>
            <div class="input-group">
                <label for="textColor">Text Color (hex):</label>
                <input type="color" id="textColor" value="#323130">
            </div>
            <div class="input-group">
                <label for="bgColor">Background Color (hex):</label>
                <input type="color" id="bgColor" value="#ffffff">
            </div>
            <div class="input-group">
                <label>
                    <input type="checkbox" id="largeText"> Large text (3:1 ratio minimum)
                </label>
            </div>
            <button class="button button-primary" onclick="testContrast()">Test Contrast</button>
            <div id="contrastResult" class="result-box" style="display: none;"></div>
        </div>

        <!-- HTML Validation -->
        <div class="demo-section">
            <h2>üîß HTML Accessibility Validation</h2>
            <p>Test HTML content for accessibility issues and automatic fixes:</p>
            <div class="input-group">
                <label for="htmlInput">HTML Content:</label>
                <textarea id="htmlInput" rows="6" placeholder="Enter HTML content to validate...">
<div style="color: #999; background-color: yellow;">
    <h3>Sample Wireframe Section</h3>
    <p>This text has poor contrast and needs fixing.</p>
    <img src="placeholder.jpg">
    <button>Click me</button>
</div></textarea>
            </div>
            <div>
                <button class="button button-primary" onclick="validateHtml(false)">Validate Only</button>
                <button class="button button-success" onclick="validateHtml(true)">Validate & Fix</button>
            </div>
            <div id="htmlValidationResult"></div>
        </div>

        <!-- Real-time Page Analysis -->
        <div class="demo-section">
            <h2>üìä Real-time Page Analysis</h2>
            <p>Analyze the current page for accessibility issues:</p>
            <button class="button button-primary" onclick="analyzeCurrentPage()">Analyze Page</button>
            <div class="stats" id="pageStats" style="display: none;"></div>
            <div id="pageAnalysisResult"></div>
        </div>

        <!-- Test Wireframes -->
        <div class="demo-section">
            <h2>üèóÔ∏è Test Wireframe Generation</h2>
            <p>Generate a test wireframe with accessibility validation:</p>
            <div class="input-group">
                <label for="wireframePrompt">Wireframe Description:</label>
                <textarea id="wireframePrompt" rows="3"
                    placeholder="Describe the wireframe you want to generate...">Create a modern contact form with name, email, phone, message fields and a submit button using Microsoft Blue theme</textarea>
            </div>
            <button class="button button-primary" onclick="generateTestWireframe()">Generate Wireframe</button>
            <div id="wireframeResult"></div>
        </div>

        <!-- Developer Console -->
        <div class="demo-section">
            <h2>üíª Developer Console</h2>
            <p>Real-time logging and debugging information:</p>
            <div class="log-output" id="consoleLog">Accessibility system initialized...\nReady for testing.\n</div>
            <button class="button button-secondary" onclick="clearConsole()">Clear Console</button>
        </div>
    </div>

    <script type="module">
        // Import our accessibility helper
        import { AccessibilityHelper } from '/src/utils/AccessibilityHelper.ts';

        const accessHelper = new AccessibilityHelper();
        let logElement;

        // Make functions globally available
        window.accessHelper = accessHelper;
        window.testContrast = testContrast;
        window.validateHtml = validateHtml;
        window.analyzeCurrentPage = analyzeCurrentPage;
        window.generateTestWireframe = generateTestWireframe;
        window.clearConsole = clearConsole;

        function log(message, type = 'info') {
            if (!logElement) logElement = document.getElementById('consoleLog');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è';
            logElement.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function clearConsole() {
            if (!logElement) logElement = document.getElementById('consoleLog');
            logElement.textContent = 'Console cleared.\n';
        }

        // Initialize color palette
        function initColorPalette() {
            const colors = accessHelper.getApprovedColors();
            const palette = document.getElementById('colorPalette');

            Object.entries(colors).forEach(([name, color]) => {
                const card = document.createElement('div');
                card.className = 'color-card';
                card.style.backgroundColor = color;
                card.style.color = accessHelper.getAccessibleTextColor(color);
                card.innerHTML = `
                    <strong>${name}</strong><br>
                    ${color}<br>
                    <small>Contrast: ${accessHelper.checkContrast('#000000', color).ratio.toFixed(2)}:1</small>
                `;
                palette.appendChild(card);
            });

            log(`Loaded ${Object.keys(colors).length} approved colors`);
        }

        function testContrast() {
            const textColor = document.getElementById('textColor').value;
            const bgColor = document.getElementById('bgColor').value;
            const isLargeText = document.getElementById('largeText').checked;

            log(`Testing contrast: ${textColor} on ${bgColor} (Large: ${isLargeText})`);

            const result = accessHelper.checkContrast(textColor, bgColor, isLargeText);
            const resultDiv = document.getElementById('contrastResult');

            resultDiv.style.display = 'block';
            resultDiv.className = `result-box ${result.isValid ? 'success' : 'error'}`;
            resultDiv.innerHTML = `
                <h3>Contrast Test Result</h3>
                <p><strong>Ratio:</strong> ${result.ratio.toFixed(2)}:1</p>
                <p><strong>Level:</strong> ${result.level}</p>
                <p><strong>Status:</strong> ${result.isValid ? '‚úÖ Passes' : '‚ùå Fails'} WCAG ${isLargeText ? 'Large Text' : 'Normal Text'}</p>
                <div style="background: ${bgColor}; color: ${textColor}; padding: 10px; margin: 10px 0; border-radius: 4px;">
                    Sample text with this color combination
                </div>
            `;

            log(`Contrast result: ${result.ratio.toFixed(2)}:1 (${result.level}) - ${result.isValid ? 'PASS' : 'FAIL'}`, result.isValid ? 'success' : 'error');
        }

        async function validateHtml(enforceCompliance) {
            const htmlContent = document.getElementById('htmlInput').value;
            const resultDiv = document.getElementById('htmlValidationResult');

            log(`Validating HTML (${enforceCompliance ? 'with fixes' : 'report only'})`);

            try {
                resultDiv.innerHTML = '<p>üîÑ Validating HTML...</p>';

                const result = await accessHelper.validateHtml(htmlContent, enforceCompliance);

                let html = '<div class="accessibility-report">';
                html += '<h3>Validation Report</h3>';

                if (result.report) {
                    html += `<div class="stats">`;
                    html += `<div class="stat-card"><div class="stat-value">${result.report.issuesFound}</div><div class="stat-label">Issues Found</div></div>`;
                    html += `<div class="stat-card"><div class="stat-value">${result.report.issuesFixed}</div><div class="stat-label">Issues Fixed</div></div>`;
                    html += `<div class="stat-card"><div class="stat-value">${result.report.contrastIssues}</div><div class="stat-label">Contrast Issues</div></div>`;
                    html += '</div>';

                    if (result.report.fixes && result.report.fixes.length > 0) {
                        html += '<h4>Applied Fixes:</h4>';
                        result.report.fixes.forEach(fix => {
                            html += `<div class="issue-item success">‚úÖ ${fix}</div>`;
                        });
                    }

                    if (result.report.warnings && result.report.warnings.length > 0) {
                        html += '<h4>Warnings:</h4>';
                        result.report.warnings.forEach(warning => {
                            html += `<div class="issue-item">‚ö†Ô∏è ${warning}</div>`;
                        });
                    }
                }

                if (result.fixedHtml && enforceCompliance) {
                    html += '<h4>Fixed HTML:</h4>';
                    html += `<div class="test-area">${result.fixedHtml}</div>`;
                }

                html += '</div>';
                resultDiv.innerHTML = html;

                log(`Validation complete: ${result.report?.issuesFound || 0} issues found, ${result.report?.issuesFixed || 0} fixed`, 'success');

            } catch (error) {
                resultDiv.innerHTML = `<div class="result-box error"><h3>Validation Error</h3><p>${error.message}</p></div>`;
                log(`Validation failed: ${error.message}`, 'error');
            }
        }

        function analyzeCurrentPage() {
            log('Analyzing current page for accessibility issues');

            const report = accessHelper.generatePageReport();
            const statsDiv = document.getElementById('pageStats');
            const resultDiv = document.getElementById('pageAnalysisResult');

            // Update stats
            statsDiv.style.display = 'grid';
            statsDiv.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${report.issues.length}</div>
                    <div class="stat-label">Issues Found</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${document.querySelectorAll('img').length}</div>
                    <div class="stat-label">Images</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${document.querySelectorAll('h1,h2,h3,h4,h5,h6').length}</div>
                    <div class="stat-label">Headings</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${document.querySelectorAll('button,a,input,select,textarea').length}</div>
                    <div class="stat-label">Interactive Elements</div>
                </div>
            `;

            // Show report
            let html = '<div class="accessibility-report">';
            html += '<h3>Page Accessibility Report</h3>';

            if (report.issues.length > 0) {
                html += '<h4>Issues Found:</h4>';
                report.issues.forEach(issue => {
                    html += `<div class="issue-item error">‚ùå ${issue.type}: ${issue.element} - ${issue.recommendation}</div>`;
                });
            } else {
                html += '<div class="issue-item success">‚úÖ No major accessibility issues found!</div>';
            }

            html += '<h4>General Recommendations:</h4>';
            report.recommendations.forEach(rec => {
                html += `<div class="issue-item">üí° ${rec}</div>`;
            });

            html += '</div>';
            resultDiv.innerHTML = html;

            log(`Page analysis complete: ${report.issues.length} issues found`, report.issues.length > 0 ? 'error' : 'success');
        }

        async function generateTestWireframe() {
            const prompt = document.getElementById('wireframePrompt').value;
            const resultDiv = document.getElementById('wireframeResult');

            log(`Generating test wireframe: "${prompt}"`);

            try {
                resultDiv.innerHTML = '<p>üîÑ Generating wireframe with accessibility validation...</p>';

                // Mock wireframe generation with accessibility features
                setTimeout(() => {
                    const mockHtml = `
                        <div style="background-color: #f3f2f1; padding: 20px; border-radius: 8px; font-family: 'Segoe UI', sans-serif;">
                            <h2 style="color: #0078d4; margin-bottom: 20px;">Contact Form</h2>
                            <form style="display: grid; gap: 15px;">
                                <div>
                                    <label for="name" style="display: block; color: #323130; font-weight: 500; margin-bottom: 5px;">Name *</label>
                                    <input type="text" id="name" required style="width: 100%; padding: 10px; border: 1px solid #edebe9; border-radius: 4px;">
                                </div>
                                <div>
                                    <label for="email" style="display: block; color: #323130; font-weight: 500; margin-bottom: 5px;">Email *</label>
                                    <input type="email" id="email" required style="width: 100%; padding: 10px; border: 1px solid #edebe9; border-radius: 4px;">
                                </div>
                                <div>
                                    <label for="phone" style="display: block; color: #323130; font-weight: 500; margin-bottom: 5px;">Phone</label>
                                    <input type="tel" id="phone" style="width: 100%; padding: 10px; border: 1px solid #edebe9; border-radius: 4px;">
                                </div>
                                <div>
                                    <label for="message" style="display: block; color: #323130; font-weight: 500; margin-bottom: 5px;">Message *</label>
                                    <textarea id="message" required rows="4" style="width: 100%; padding: 10px; border: 1px solid #edebe9; border-radius: 4px; resize: vertical;"></textarea>
                                </div>
                                <button type="submit" style="background-color: #0078d4; color: #ffffff; border: none; padding: 12px 24px; border-radius: 4px; font-weight: 500; cursor: pointer;">
                                    Submit Message
                                </button>
                            </form>
                        </div>
                    `;

                    resultDiv.innerHTML = `
                        <div class="accessibility-report">
                            <h3>Generated Wireframe</h3>
                            <div class="issue-item success">‚úÖ All colors meet WCAG AA standards</div>
                            <div class="issue-item success">‚úÖ Proper form labels and structure</div>
                            <div class="issue-item success">‚úÖ Keyboard accessible elements</div>
                            <div class="issue-item success">‚úÖ Semantic HTML markup</div>
                            <h4>Preview:</h4>
                            <div class="test-area">${mockHtml}</div>
                        </div>
                    `;

                    log('Test wireframe generated successfully with full accessibility compliance', 'success');
                }, 1500);

            } catch (error) {
                resultDiv.innerHTML = `<div class="result-box error"><h3>Generation Error</h3><p>${error.message}</p></div>`;
                log(`Wireframe generation failed: ${error.message}`, 'error');
            }
        }

        // Initialize the demo
        document.addEventListener('DOMContentLoaded', () => {
            initColorPalette();
            log('Accessibility demo system initialized', 'success');
        });
    </script>
</body>

</html>