<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag Test</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }

        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .drag-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .drag-button:hover {
            background: #0056b3;
        }

        .test-element {
            padding: 15px;
            margin: 10px 0;
            background: #e9ecef;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            cursor: move;
        }

        .test-element:hover {
            background: #d1ecf1;
            border-color: #bee5eb;
        }
    </style>
</head>

<body>
    <div class="test-container">
        <h1>üß™ SimpleDragWireframe Test</h1>
        <p>This test will help verify if the drag functionality is working in the React component.</p>

        <button class="drag-button" onclick="toggleDrag()">üîì Drag Mode: OFF</button>

        <div id="container">
            <div class="test-element">
                <h3>Header Element</h3>
                <p>This is a test header element that should be draggable when drag mode is enabled.</p>
            </div>

            <div class="test-element">
                <h3>Content Element</h3>
                <p>This is a content element with some sample text to drag around.</p>
            </div>

            <div class="test-element">
                <h3>Footer Element</h3>
                <p>This footer element should also be draggable in drag mode.</p>
            </div>
        </div>

        <div
            style="margin-top: 30px; padding: 15px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px;">
            <h4>üîç Expected Behavior:</h4>
            <ol>
                <li>Click the "Drag Mode: OFF" button - it should turn green and say "Drag Mode: ON"</li>
                <li>When drag mode is ON, hover over elements - they should show drag cursor (grab/grabbing)</li>
                <li>Click and drag elements - they should be draggable and reorderable</li>
                <li>Click button again to turn off drag mode - elements should not be draggable</li>
            </ol>
            <p><strong>If this works here but not in React:</strong> The issue is likely with React state management or
                event handling.</p>
        </div>

        <div
            style="margin-top: 20px; padding: 15px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px;">
            <h4>üìù Debug Info:</h4>
            <p>Drag Mode Status: <span id="status">DISABLED</span></p>
            <p>Dragula Instance: <span id="dragula-status">Not initialized</span></p>
            <p>Console Messages: Check browser console for debug logs</p>
        </div>
    </div>

    <!-- Include dragula from CDN for testing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.3/dragula.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.3/dragula.min.css">

    <script>
        let isDragEnabled = false;
        let dragulaInstance = null;

        function toggleDrag() {
            isDragEnabled = !isDragEnabled;
            console.log('Toggle drag clicked. New state:', isDragEnabled);

            const button = document.querySelector('.drag-button');
            const status = document.getElementById('status');
            const container = document.getElementById('container');

            // Update button and status
            if (isDragEnabled) {
                button.textContent = 'üîí Drag Mode: ON';
                button.style.background = '#28a745';
                status.textContent = 'ENABLED';
                container.classList.add('drag-enabled');
                container.classList.remove('drag-disabled');
            } else {
                button.textContent = 'üîì Drag Mode: OFF';
                button.style.background = '#6c757d';
                status.textContent = 'DISABLED';
                container.classList.add('drag-disabled');
                container.classList.remove('drag-enabled');
            }

            // Reinitialize dragula
            if (dragulaInstance) {
                dragulaInstance.destroy();
                console.log('Destroyed previous dragula instance');
            }

            dragulaInstance = dragula([container], {
                moves: function (el, source, handle, sibling) {
                    console.log('Dragula moves check:', isDragEnabled);
                    return isDragEnabled;
                },
                accepts: function (el, target, source, sibling) {
                    console.log('Dragula accepts check:', isDragEnabled && target === container);
                    return isDragEnabled && target === container;
                }
            });

            dragulaInstance.on('drag', function (el) {
                console.log('Drag started for:', el.querySelector('h3')?.textContent);
            });

            dragulaInstance.on('drop', function (el) {
                console.log('Drop completed for:', el.querySelector('h3')?.textContent);
            });

            document.getElementById('dragula-status').textContent = 'Initialized with drag: ' + (isDragEnabled ? 'ENABLED' : 'DISABLED');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function () {
            console.log('Page loaded, initializing test...');
            toggleDrag(); // This will initialize with drag disabled
            toggleDrag(); // This will reset to disabled state properly
        });
    </script>
</body>

</html>