<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Quick Production Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }

        .test-button {
            padding: 15px 30px;
            margin: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .primary {
            background: #0078d4;
            color: white;
        }

        .success {
            background: #107c10;
            color: white;
        }

        .danger {
            background: #d13438;
            color: white;
        }

        .result {
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #ccc;
        }

        .success-result {
            border-left-color: #107c10;
            background: #f3f9f3;
        }

        .error-result {
            border-left-color: #d13438;
            background: #fdf3f3;
        }

        .loading-result {
            border-left-color: #0078d4;
            background: #f3f8fd;
        }

        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
            font-size: 12px;
        }

        .wireframe-output {
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üß™ Production Wireframe Test</h1>
        <p><strong>Backend:</strong> https://func-designetica-vdlmicyosd4ua.azurewebsites.net</p>
        <p><strong>Status:</strong> <span id="status">Ready to test</span></p>

        <button class="test-button primary" onclick="testQuickWireframe()">üöÄ Test Quick Wireframe</button>
        <button class="test-button success" onclick="testFullWireframe()">‚ö° Test Full Wireframe</button>
        <button class="test-button danger" onclick="clearResults()">üóëÔ∏è Clear Results</button>

        <div id="results"></div>
    </div>

    <script>
        const BACKEND_URL = 'https://func-designetica-vdlmicyosd4ua.azurewebsites.net';

        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }

        function addResult(message, type = 'info', isHtml = false) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}-result`;

            if (isHtml) {
                div.innerHTML = message;
            } else {
                div.textContent = message;
            }

            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }

        async function testQuickWireframe() {
            updateStatus('Testing quick wireframe...');
            addResult('üöÄ Starting quick wireframe test...', 'loading');

            try {
                const startTime = Date.now();

                const response = await fetch(`${BACKEND_URL}/api/generate-html-wireframe`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        description: 'Create a simple login form with email field and password field',
                        fastMode: true,
                        useTemplates: true
                    })
                });

                const duration = ((Date.now() - startTime) / 1000).toFixed(2);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                updateStatus('‚úÖ Quick test completed successfully!');
                addResult(`‚úÖ Quick wireframe generated in ${duration}s`, 'success');

                if (data.html) {
                    addResult(`<strong>Generated HTML:</strong><div class="wireframe-output"><pre>${data.html.substring(0, 1000)}${data.html.length > 1000 ? '...' : ''}</pre></div>`, 'success', true);
                }

                addResult(`Source: ${data.source || 'unknown'}`, 'info');

            } catch (error) {
                updateStatus('‚ùå Quick test failed');
                addResult(`‚ùå Quick wireframe failed: ${error.message}`, 'error');
            }
        }

        async function testFullWireframe() {
            updateStatus('Testing full wireframe generation...');
            addResult('‚ö° Starting full wireframe test (may take 30-60 seconds)...', 'loading');

            try {
                const startTime = Date.now();

                const response = await fetch(`${BACKEND_URL}/api/generate-html-wireframe`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        description: 'Create a comprehensive Microsoft Learn dashboard with course progress tracking, certification paths, hands-on lab access, learning analytics, and skill assessments',
                        fastMode: false,
                        useTemplates: false
                    })
                });

                const duration = ((Date.now() - startTime) / 1000).toFixed(2);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                updateStatus('‚úÖ Full test completed successfully!');
                addResult(`‚úÖ Full wireframe generated in ${duration}s`, 'success');

                if (data.html) {
                    addResult(`<strong>Generated HTML:</strong><div class="wireframe-output"><pre>${data.html.substring(0, 1000)}${data.html.length > 1000 ? '...' : ''}</pre></div>`, 'success', true);
                }

                addResult(`AI Generated: ${data.aiGenerated ? 'Yes' : 'No'}`, 'info');
                addResult(`Source: ${data.source || 'unknown'}`, 'info');

            } catch (error) {
                updateStatus('‚ùå Full test failed');
                addResult(`‚ùå Full wireframe failed: ${error.message}`, 'error');
            }
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            updateStatus('Ready to test');
        }

        // Auto-warm the function
        fetch(`${BACKEND_URL}/api/health`).then(() => {
            updateStatus('‚úÖ Function warmed up - ready to test');
        }).catch(() => {
            updateStatus('‚ö†Ô∏è Function may be cold - first test might be slower');
        });
    </script>
</body>

</html>