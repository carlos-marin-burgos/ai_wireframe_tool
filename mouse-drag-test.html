<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mouse Drag Drop Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }

        .container {
            width: 800px;
            height: 500px;
            border: 2px dashed #ccc;
            margin: 20px auto;
            position: relative;
            background: #f9f9f9;
            border-radius: 8px;
        }

        .container.dragging {
            border-color: #007bff;
            background: #f0f7ff;
            border-style: solid;
        }

        .draggable {
            position: absolute;
            padding: 12px 20px;
            background: #007bff;
            color: white;
            border-radius: 6px;
            cursor: grab;
            user-select: none;
            transition: all 0.2s ease;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .draggable:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
            outline: 2px dashed rgba(0, 123, 255, 0.4);
            outline-offset: 2px;
        }

        .dragging-element {
            opacity: 0.3 !important;
            transform: scale(0.98);
        }

        .ghost {
            position: fixed;
            pointer-events: none;
            opacity: 0.7;
            z-index: 9999;
            transform: rotate(3deg) scale(0.95);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3) !important;
            border: 2px solid rgba(0, 123, 255, 0.8) !important;
        }

        .form-element {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 6px;
            min-width: 200px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            cursor: grab;
        }

        .form-element input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin: 5px 0;
            box-sizing: border-box;
        }

        .instructions {
            text-align: center;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
            max-width: 600px;
        }

        .drag-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 123, 255, 0.1);
            pointer-events: none;
            z-index: 998;
        }

        .drag-instruction {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 123, 255, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }
    </style>
</head>

<body>
    <h1 style="text-align: center;">üñ±Ô∏è Mouse-Based Drag & Drop Test</h1>

    <div class="instructions">
        <h3>üéØ How to Test Mouse Drag and Drop</h3>
        <p><strong>1.</strong> Hover over any colored element to see the grab cursor</p>
        <p><strong>2.</strong> Click and hold, then drag elements around the canvas</p>
        <p><strong>3.</strong> Release to drop elements in their new positions</p>
        <p><strong>4.</strong> Watch for visual feedback during dragging</p>
    </div>

    <div class="container" id="canvas">
        <!-- Pre-placed draggable elements -->
        <div class="draggable" style="top: 20px; left: 20px;" data-draggable="true">
            üîò Button 1
        </div>

        <div class="draggable" style="top: 20px; left: 200px;" data-draggable="true">
            üîò Button 2
        </div>

        <div class="form-element" style="top: 80px; left: 20px;" data-draggable="true">
            <label><strong>üìù Contact Form</strong></label>
            <input type="text" placeholder="Enter your name" readonly>
            <input type="email" placeholder="Enter your email" readonly>
        </div>

        <div class="draggable" style="top: 200px; left: 20px;" data-draggable="true">
            ‚úÖ Submit
        </div>

        <div class="form-element" style="top: 250px; left: 300px;" data-draggable="true">
            <label><strong>üí¨ Feedback</strong></label>
            <input type="text" placeholder="Your feedback" readonly>
        </div>
    </div>

    <div style="text-align: center; margin: 20px;">
        <button onclick="addNewElement()"
            style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px;">
            ‚ûï Add New Element
        </button>
        <button onclick="clearAll()"
            style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px;">
            üóëÔ∏è Clear All
        </button>
        <button onclick="resetPositions()"
            style="padding: 10px 20px; background: #6f42c1; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 5px;">
            üîÑ Reset Positions
        </button>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        let isDragging = false;
        let dragElement = null;
        let ghostElement = null;
        let dragOffset = { x: 0, y: 0 };
        let elementCounter = 2;

        // Check if element is draggable
        function isDraggableElement(element) {
            return element.hasAttribute('data-draggable');
        }

        // Create ghost element
        function createGhost(element) {
            const ghost = element.cloneNode(true);
            ghost.classList.add('ghost');
            ghost.style.position = 'fixed';
            ghost.style.pointerEvents = 'none';
            document.body.appendChild(ghost);
            return ghost;
        }

        // Mouse down handler
        canvas.addEventListener('mousedown', (e) => {
            let target = e.target;

            // Find draggable element (could be nested)
            while (target && target !== canvas) {
                if (isDraggableElement(target)) {
                    break;
                }
                target = target.parentElement;
            }

            if (!target || !isDraggableElement(target)) return;

            e.preventDefault();
            e.stopPropagation();

            const rect = target.getBoundingClientRect();
            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;

            dragElement = target;
            isDragging = true;

            // Visual feedback
            canvas.classList.add('dragging');
            target.classList.add('dragging-element');

            // Create ghost
            ghostElement = createGhost(target);
            ghostElement.style.left = `${e.clientX - dragOffset.x}px`;
            ghostElement.style.top = `${e.clientY - dragOffset.y}px`;

            // Add overlay
            const overlay = document.createElement('div');
            overlay.className = 'drag-overlay';
            overlay.innerHTML = '<div class="drag-instruction">üñ±Ô∏è Move mouse to position element</div>';
            document.body.appendChild(overlay);

            console.log('üéØ Started dragging:', target.textContent);
        });

        // Mouse move handler
        document.addEventListener('mousemove', (e) => {
            if (!isDragging || !ghostElement) return;

            e.preventDefault();
            ghostElement.style.left = `${e.clientX - dragOffset.x}px`;
            ghostElement.style.top = `${e.clientY - dragOffset.y}px`;
        });

        // Mouse up handler
        document.addEventListener('mouseup', (e) => {
            if (!isDragging || !dragElement) return;

            e.preventDefault();

            // Check if dropping inside canvas
            const canvasRect = canvas.getBoundingClientRect();
            const isInsideCanvas = e.clientX >= canvasRect.left &&
                e.clientX <= canvasRect.right &&
                e.clientY >= canvasRect.top &&
                e.clientY <= canvasRect.bottom;

            if (isInsideCanvas) {
                // Calculate new position
                const newX = e.clientX - canvasRect.left - dragOffset.x;
                const newY = e.clientY - canvasRect.top - dragOffset.y;

                // Keep within bounds
                const elementRect = dragElement.getBoundingClientRect();
                const maxX = canvasRect.width - elementRect.width;
                const maxY = canvasRect.height - elementRect.height;

                const boundedX = Math.max(10, Math.min(maxX - 10, newX));
                const boundedY = Math.max(10, Math.min(maxY - 10, newY));

                // Position element
                dragElement.style.left = `${boundedX}px`;
                dragElement.style.top = `${boundedY}px`;

                console.log(`üìç Dropped at: ${Math.round(boundedX)}, ${Math.round(boundedY)}`);
            }

            // Clean up
            canvas.classList.remove('dragging');
            dragElement.classList.remove('dragging-element');

            if (ghostElement) {
                document.body.removeChild(ghostElement);
                ghostElement = null;
            }

            // Remove overlay
            const overlay = document.querySelector('.drag-overlay');
            if (overlay) {
                document.body.removeChild(overlay);
            }

            isDragging = false;
            dragElement = null;
            dragOffset = { x: 0, y: 0 };
        });

        // Helper functions
        function addNewElement() {
            elementCounter++;
            const newElement = document.createElement('div');
            newElement.className = 'draggable';
            newElement.setAttribute('data-draggable', 'true');
            newElement.style.top = '50px';
            newElement.style.left = '50px';
            newElement.textContent = `üÜï Element ${elementCounter}`;

            canvas.appendChild(newElement);
            console.log('‚ûï Added:', newElement.textContent);
        }

        function clearAll() {
            if (confirm('Clear all elements?')) {
                const draggables = canvas.querySelectorAll('[data-draggable]');
                draggables.forEach(el => el.remove());
                elementCounter = 0;
                console.log('üóëÔ∏è Cleared all elements');
            }
        }

        function resetPositions() {
            const elements = canvas.querySelectorAll('[data-draggable]');
            let x = 20, y = 20;

            elements.forEach((el, index) => {
                el.style.left = `${x}px`;
                el.style.top = `${y}px`;

                x += 150;
                if (x > 600) {
                    x = 20;
                    y += 80;
                }
            });

            console.log('üîÑ Reset all positions');
        }
    </script>
</body>

</html>