# 🏢 Power Apps Model-Driven App Example - Wireframe Management

## 📋 **Entity Configuration for Wireframe Management**

### **Custom Tables Structure**

```
Wireframe Projects (cr4e1_wireframeproject)
├── Fields:
│   ├── Project Name (cr4e1_name) - Text
│   ├── Description (cr4e1_description) - Multiline Text
│   ├── Client (cr4e1_client) - Text
│   ├── Status (cr4e1_status) - Choice
│   ├── Priority (cr4e1_priority) - Choice
│   ├── Created Date (createdon) - DateTime
│   └── Owner (ownerid) - Lookup
│
├── Wireframe Generations (cr4e1_wireframegeneration)
│   ├── Generation Name (cr4e1_name) - Text
│   ├── Parent Project (cr4e1_projectid) - Lookup
│   ├── AI Prompt (cr4e1_aiprompt) - Multiline Text
│   ├── Theme (cr4e1_theme) - Choice
│   ├── Generated HTML (cr4e1_generatedhtml) - Multiline Text
│   ├── Generation Status (cr4e1_status) - Choice
│   ├── Processing Time (cr4e1_processingtime) - Number
│   ├── Correlation ID (cr4e1_correlationid) - Text
│   ├── AI Suggestions (cr4e1_aisuggestions) - Multiline Text
│   ├── Generated On (cr4e1_generatedon) - DateTime
│   └── Generated By (cr4e1_generatedby) - Lookup
│
└── Generation Reviews (cr4e1_generationreview)
    ├── Review Name (cr4e1_name) - Text
    ├── Parent Generation (cr4e1_generationid) - Lookup
    ├── Reviewer (cr4e1_reviewer) - Lookup
    ├── Rating (cr4e1_rating) - Choice
    ├── Feedback (cr4e1_feedback) - Multiline Text
    ├── Approved (cr4e1_approved) - Yes/No
    └── Review Date (cr4e1_reviewdate) - DateTime
```

## 🎯 **Choice Field Configurations**

### **Project Status Choices**

```json
{
  "cr4e1_status": [
    { "value": 727280000, "label": "Draft" },
    { "value": 727280001, "label": "In Progress" },
    { "value": 727280002, "label": "Review" },
    { "value": 727280003, "label": "Approved" },
    { "value": 727280004, "label": "Completed" },
    { "value": 727280005, "label": "On Hold" }
  ]
}
```

### **Priority Choices**

```json
{
  "cr4e1_priority": [
    { "value": 727280000, "label": "Low" },
    { "value": 727280001, "label": "Medium" },
    { "value": 727280002, "label": "High" },
    { "value": 727280003, "label": "Critical" }
  ]
}
```

### **Theme Choices**

```json
{
  "cr4e1_theme": [
    { "value": 727280000, "label": "Microsoft Learn" },
    { "value": 727280001, "label": "Minimal" },
    { "value": 727280002, "label": "Modern" },
    { "value": 727280003, "label": "Classic" }
  ]
}
```

### **Generation Status Choices**

```json
{
  "cr4e1_status": [
    { "value": 727280000, "label": "Pending" },
    { "value": 727280001, "label": "Processing" },
    { "value": 727280002, "label": "Completed" },
    { "value": 727280003, "label": "Failed" },
    { "value": 727280004, "label": "Cancelled" }
  ]
}
```

### **Review Rating Choices**

```json
{
  "cr4e1_rating": [
    { "value": 727280000, "label": "⭐ Poor" },
    { "value": 727280001, "label": "⭐⭐ Fair" },
    { "value": 727280002, "label": "⭐⭐⭐ Good" },
    { "value": 727280003, "label": "⭐⭐⭐⭐ Very Good" },
    { "value": 727280004, "label": "⭐⭐⭐⭐⭐ Excellent" }
  ]
}
```

## 🔄 **Power Automate Integration Flows**

### **Flow 1: Auto-Generate Wireframe**

```yaml
Flow Name: "Auto-Generate Wireframe from Project"
Trigger: "When a Wireframe Generation record is created"

Steps:
1. Get Project Details:
   - Input: Generation.ProjectId
   - Output: Project record

2. Prepare AI Prompt:
   - Combine: Project.Description + Generation.AIPrompt
   - Add context: Project.Client, Priority

3. Call Designetica API:
   - Endpoint: /api/generate-wireframe
   - Method: POST
   - Body:
     description: Combined prompt
     theme: Generation.Theme
     colorScheme: "primary"

4. Update Generation Record:
   - Generated HTML: API Response HTML
   - Processing Time: API Response time
   - Correlation ID: API Response ID
   - Status: "Completed" or "Failed"
   - Generated On: Current timestamp

5. Send Notification:
   - To: Generation.GeneratedBy
   - Subject: "Wireframe Ready: {Generation.Name}"
   - Body: Include preview link and download options
```

### **Flow 2: Generate AI Suggestions**

```yaml
Flow Name: "Generate Enhancement Suggestions"
Trigger: "Manual trigger from Generation form"

Steps:
1. Get Generation Context:
  - Current HTML content
  - Project requirements
  - User feedback history

2. Call Suggestions API:
  - Endpoint: /api/generate-suggestions
  - Method: POST
  - Body:
    html: Generation.GeneratedHTML
    context: Project context

3. Update Generation:
  - AI Suggestions: API Response
  - Last Suggestion Date: Now()

4. Create Review Record:
  - Auto-create review with AI suggestions
  - Assign to project owner
  - Status: "Pending Review"
```

### **Flow 3: Approval Workflow**

```yaml
Flow Name: "Wireframe Approval Process"
Trigger: "When Generation status changes to 'Review'"

Steps:
1. Get Approvers:
  - Project owner
  - Designated reviewers
  - Client stakeholders (if external)

2. Send Approval Request:
  - Create approval flow
  - Include wireframe preview
  - Set 48-hour timeout

3. Process Approval:
  - If Approved: Update status to "Approved"
  - If Rejected: Update status to "Draft", notify creator
  - If Timeout: Escalate to manager

4. Log Activity:
  - Create audit trail
  - Update project timeline
  - Send completion notifications
```

## 📋 **Business Process Flows**

### **Wireframe Development Process**

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Create        │    │   Generate      │    │   Review &      │
│   Project       │───▶│   Wireframes    │───▶│   Approve       │
│                 │    │                 │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ • Define scope  │    │ • AI generation │    │ • Quality check │
│ • Set priority  │    │ • Manual refine │    │ • Client review │
│ • Assign team   │    │ • Test & verify │    │ • Final approval│
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### **Stage Gates & Requirements**

#### **Stage 1: Project Initiation**

- **Entry Criteria:**

  - Project name defined
  - Client/stakeholder identified
  - High-level requirements gathered

- **Activities:**

  - Complete project setup form
  - Define success criteria
  - Assign project team roles

- **Exit Criteria:**
  - Project status = "In Progress"
  - Initial requirements documented
  - Team assignments confirmed

#### **Stage 2: Wireframe Generation**

- **Entry Criteria:**

  - Project approved and active
  - Detailed requirements available
  - Team resources allocated

- **Activities:**

  - Create generation requests
  - Run AI wireframe generation
  - Manual refinements and iterations
  - Internal testing and validation

- **Exit Criteria:**
  - At least one wireframe generated
  - Quality standards met
  - Ready for stakeholder review

#### **Stage 3: Review & Approval**

- **Entry Criteria:**

  - Wireframe generation completed
  - Quality checkpoints passed
  - Review team assigned

- **Activities:**

  - Stakeholder review sessions
  - Feedback collection and analysis
  - Approval decision making
  - Documentation finalization

- **Exit Criteria:**
  - Formal approval obtained
  - All feedback addressed
  - Project deliverables complete

## 📊 **Dashboard and Views Configuration**

### **Project Manager Dashboard**

```yaml
Charts:
1. Projects by Status (Donut Chart):
  - Data: Wireframe Projects
  - Group by: Status
  - Show: Count and percentage

2. Generation Activity (Line Chart):
  - Data: Wireframe Generations
  - X-axis: Generated On (by week)
  - Y-axis: Count of generations
  - Series: Theme used

3. Processing Performance (Bar Chart):
  - Data: Wireframe Generations
  - X-axis: Theme
  - Y-axis: Average Processing Time
  - Filter: Last 30 days

4. Review Ratings (Horizontal Bar):
  - Data: Generation Reviews
  - X-axis: Rating distribution
  - Y-axis: Count
  - Color: Rating level
```

### **Team Performance Metrics**

```yaml
KPIs:
1. Active Projects: Count(Projects where Status in [Draft, In Progress, Review])
2. Avg Generation Time: Average(Generations.ProcessingTime) where Status = Completed
3. Approval Rate: (Approved Reviews / Total Reviews) * 100
4. Client Satisfaction: Average(Reviews.Rating) where Approved = Yes

Filters:
  - Date Range: Last 30, 60, 90 days, Custom
  - Team Member: Multi-select user lookup
  - Client: Multi-select text filter
  - Project Status: Multi-select choice
```

## 🎨 **Form Customizations**

### **Project Creation Form**

```javascript
// Form OnLoad event
function onProjectFormLoad(executionContext) {
  var formContext = executionContext.getFormContext();

  // Set default priority based on client
  var clientField = formContext.getAttribute("cr4e1_client");
  var priorityField = formContext.getAttribute("cr4e1_priority");

  if (clientField.getValue()) {
    // Auto-set priority for VIP clients
    var vipClients = ["Microsoft", "Azure", "Enterprise"];
    var client = clientField.getValue();

    if (vipClients.some((vip) => client.includes(vip))) {
      priorityField.setValue(727280002); // High priority
    }
  }

  // Enable auto-save
  formContext.data.entity.addOnSave(autoSaveProgress);
}

// Auto-save project progress
function autoSaveProgress(executionContext) {
  // Track form changes for audit
  console.log("Project updated: " + new Date().toISOString());
}
```

### **Generation Request Form**

```javascript
// Generation form with AI prompt helper
function onGenerationFormLoad(executionContext) {
  var formContext = executionContext.getFormContext();

  // Add AI prompt suggestions
  addPromptSuggestions(formContext);

  // Real-time character counter
  var promptField = formContext.getControl("cr4e1_aiprompt");
  promptField.addOnKeyPress(updateCharacterCount);
}

function addPromptSuggestions(formContext) {
  var suggestions = [
    "Create a responsive login form with modern design",
    "Design a dashboard with charts and navigation menu",
    "Build a product catalog with search and filters",
    "Generate a contact form with validation messages",
    "Create a user profile page with edit capabilities",
  ];

  // Add suggestion buttons to form
  suggestions.forEach((suggestion) => {
    // Implementation would use Web Resources or PCF controls
    console.log("Suggestion: " + suggestion);
  });
}
```

### **Review Form with Embedded Preview**

```javascript
// Review form with HTML preview
function onReviewFormLoad(executionContext) {
  var formContext = executionContext.getFormContext();

  // Get related generation record
  var generationId = formContext.getAttribute("cr4e1_generationid").getValue();

  if (generationId && generationId[0]) {
    // Load HTML preview in Web Resource iframe
    loadWireframePreview(generationId[0].id);
  }

  // Set up rating change handler
  var ratingField = formContext.getControl("cr4e1_rating");
  ratingField.addOnChange(updateReviewSummary);
}

function loadWireframePreview(generationId) {
  // Retrieve generation record
  Xrm.WebApi.retrieveRecord(
    "cr4e1_wireframegeneration",
    generationId,
    "?$select=cr4e1_generatedhtml"
  )
    .then(function (result) {
      var html = result.cr4e1_generatedhtml;

      // Display in iframe web resource
      var iframe = document.getElementById("WebResource_WireframePreview");
      if (iframe && html) {
        iframe.src = "data:text/html;charset=utf-8," + encodeURIComponent(html);
      }
    })
    .catch(function (error) {
      console.log("Error loading preview: " + error.message);
    });
}
```

## 🔐 **Security and Permissions**

### **Security Roles**

#### **Wireframe Project Manager**

```yaml
Entity Permissions:
  - Wireframe Projects: Create, Read, Write, Delete (Own + Team)
  - Wireframe Generations: Create, Read, Write, Delete (Own + Team)
  - Generation Reviews: Read, Write (All records)
  - System Settings: Read (Organization)

Miscellaneous Privileges:
  - Export to Excel: Organization
  - Mail Merge: Organization
  - Use Teams Integration: Organization
```

#### **Wireframe Designer**

```yaml
Entity Permissions:
  - Wireframe Projects: Read (Team), Write (Own)
  - Wireframe Generations: Create, Read, Write, Delete (Own)
  - Generation Reviews: Read (Own), Create (Own)

API Permissions:
  - Call Designetica API: Enabled
  - Export HTML: Enabled
  - View Processing Logs: Own records only
```

#### **Wireframe Reviewer**

```yaml
Entity Permissions:
  - Wireframe Projects: Read (All)
  - Wireframe Generations: Read (All)
  - Generation Reviews: Create, Read, Write (All)

Review Permissions:
  - Approve/Reject: Enabled
  - Request Changes: Enabled
  - View Performance Metrics: Team level
```

### **Field Level Security**

```yaml
Sensitive Fields (Restricted):
  - Processing Performance Data: Project Managers only
  - API Correlation IDs: System Administrators only
  - Client Contract Details: Business Unit level
  - Cost/Billing Information: Finance team only

Public Fields (All Users):
  - Project Names and Descriptions
  - Wireframe HTML (approved versions)
  - Review Comments and Ratings
  - Generation Timestamps
```

## 📈 **Advanced Analytics Configuration**

### **Power BI Integration**

```yaml
Data Export Configuration:
1. Scheduled Exports:
  - Frequency: Daily at 2 AM
  - Format: OData feed
  - Tables: All wireframe entities
  - Retention: 2 years

2. Real-time Analytics:
  - Stream: Generation completion events
  - Dashboard: Live performance metrics
  - Alerts: Performance degradation
  - Integration: Teams notifications

3. Custom Metrics:
  - AI Generation Success Rate
  - Average User Satisfaction Score
  - Theme Popularity Trends
  - Processing Time Optimization
```

### **Usage Analytics**

```sql
-- Power BI DAX Examples

// Total Generations This Month
Total_Generations_MTD =
CALCULATE(
    COUNTROWS('Wireframe Generations'),
    DATESMTD('Wireframe Generations'[Generated On])
)

// Average Processing Time by Theme
Avg_Processing_Time =
AVERAGEX(
    'Wireframe Generations',
    'Wireframe Generations'[Processing Time]
)

// Client Satisfaction Score
Client_Satisfaction =
AVERAGE('Generation Reviews'[Rating]) * 20  // Convert to percentage

// Project Completion Rate
Completion_Rate =
DIVIDE(
    COUNTROWS(FILTER('Wireframe Projects', 'Wireframe Projects'[Status] = "Completed")),
    COUNTROWS('Wireframe Projects')
) * 100
```

---

## ✅ **Implementation Checklist**

### **Phase 1: Foundation Setup**

- [ ] Create custom tables and relationships
- [ ] Configure choice fields and lookups
- [ ] Set up security roles and permissions
- [ ] Create basic forms and views

### **Phase 2: Process Automation**

- [ ] Build Power Automate flows for API integration
- [ ] Configure approval workflows
- [ ] Set up automated notifications
- [ ] Create business process flows

### **Phase 3: User Experience**

- [ ] Customize forms with JavaScript
- [ ] Create dashboards and charts
- [ ] Build HTML preview capabilities
- [ ] Configure mobile responsiveness

### **Phase 4: Analytics & Optimization**

- [ ] Set up Power BI integration
- [ ] Configure usage analytics
- [ ] Create performance monitoring
- [ ] Implement continuous improvement processes

**Enterprise-ready wireframe management in Model-Driven Apps! 🏢✨**
